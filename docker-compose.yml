services:
  cortex:
    build: .
    ports:
      - "21100:21100"
    volumes:
      - cortex-data:/app/cortex
    environment:
      - CORTEX_PORT=21100
      - CORTEX_HOST=0.0.0.0
      - CORTEX_DB_PATH=cortex/brain.db
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      # Dashboard auth (optional â€” set in .env to enable login)
      - CORTEX_AUTH_TOKEN=${CORTEX_AUTH_TOKEN:-}
      - LOG_LEVEL=info
      # Timezone: set to your local timezone, e.g. Asia/Shanghai, Asia/Tokyo, America/New_York
      - TZ=Asia/Tokyo
    restart: unless-stopped

  # Optional: Qdrant for high-performance vector search
  # Uncomment to enable, then set vectorBackend.provider to "qdrant" in config
  # qdrant:
  #   image: qdrant/qdrant:latest
  #   ports:
  #     - "6333:6333"
  #   volumes:
  #     - qdrant-data:/qdrant/storage
  #   restart: unless-stopped

volumes:
  cortex-data:
  # qdrant-data:
